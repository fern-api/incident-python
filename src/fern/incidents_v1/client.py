# This file was auto-generated by Fern from our API Definition.

import typing

from ..core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ..core.request_options import RequestOptions
from ..types.custom_field_entry_payload_v1 import CustomFieldEntryPayloadV1
from ..types.incident_role_assignment_payload_v1 import IncidentRoleAssignmentPayloadV1
from ..types.incidents_create_result_v1 import IncidentsCreateResultV1
from ..types.incidents_list_result_v1 import IncidentsListResultV1
from ..types.incidents_show_result_v1 import IncidentsShowResultV1
from .raw_client import AsyncRawIncidentsV1Client, RawIncidentsV1Client
from .types.incidents_create_payload_v1mode import IncidentsCreatePayloadV1Mode
from .types.incidents_create_payload_v1status import IncidentsCreatePayloadV1Status
from .types.incidents_create_payload_v1visibility import IncidentsCreatePayloadV1Visibility

# this is used as the default value for optional parameters
OMIT = typing.cast(typing.Any, ...)


class IncidentsV1Client:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawIncidentsV1Client(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawIncidentsV1Client:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawIncidentsV1Client
        """
        return self._raw_client

    def list(
        self,
        *,
        page_size: typing.Optional[int] = None,
        after: typing.Optional[str] = None,
        status: typing.Optional[typing.Union[str, typing.Sequence[str]]] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> IncidentsListResultV1:
        """
        List all incidents for an organisation.

        Parameters
        ----------
        page_size : typing.Optional[int]
            Integer number of records to return

        after : typing.Optional[str]
            An record's ID. This endpoint will return a list of records after this ID in relation to the API response order.

        status : typing.Optional[typing.Union[str, typing.Sequence[str]]]
            Filter for incidents in these statuses

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        IncidentsListResultV1
            OK response.

        Examples
        --------
        from fern import IncidentIO

        client = IncidentIO()
        client.incidents_v1.list(
            page_size=25,
            after="01FDAG4SAP5TYPT98WGR2N7W91",
        )
        """
        _response = self._raw_client.list(
            page_size=page_size, after=after, status=status, request_options=request_options
        )
        return _response.data

    def create(
        self,
        *,
        idempotency_key: str,
        visibility: IncidentsCreatePayloadV1Visibility,
        custom_field_entries: typing.Optional[typing.Sequence[CustomFieldEntryPayloadV1]] = OMIT,
        incident_role_assignments: typing.Optional[typing.Sequence[IncidentRoleAssignmentPayloadV1]] = OMIT,
        incident_type_id: typing.Optional[str] = OMIT,
        mode: typing.Optional[IncidentsCreatePayloadV1Mode] = OMIT,
        name: typing.Optional[str] = OMIT,
        severity_id: typing.Optional[str] = OMIT,
        slack_team_id: typing.Optional[str] = OMIT,
        source_message_channel_id: typing.Optional[str] = OMIT,
        source_message_timestamp: typing.Optional[str] = OMIT,
        status: typing.Optional[IncidentsCreatePayloadV1Status] = OMIT,
        summary: typing.Optional[str] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> IncidentsCreateResultV1:
        """
        Create a new incident.

        Parameters
        ----------
        idempotency_key : str
            Unique string used to de-duplicate incident create requests

        visibility : IncidentsCreatePayloadV1Visibility
            Whether the incident should be open to anyone in your Slack workspace (public), or invite-only (private). For more information on Private Incidents see our [help centre](https://help.incident.io/articles/5905558102-can-we-mark-incidents-as-sensitive-and-restrict-access).

        custom_field_entries : typing.Optional[typing.Sequence[CustomFieldEntryPayloadV1]]
            Set the incident's custom fields to these values

        incident_role_assignments : typing.Optional[typing.Sequence[IncidentRoleAssignmentPayloadV1]]
            Assign incident roles to these people

        incident_type_id : typing.Optional[str]
            Incident type to create this incident as

        mode : typing.Optional[IncidentsCreatePayloadV1Mode]
            Whether the incident is real or test

        name : typing.Optional[str]
            Explanation of the incident

        severity_id : typing.Optional[str]
            Severity to create incident as

        slack_team_id : typing.Optional[str]
            ID of the Slack team / workspace. This is only required if you are using a Slack Enterprise Grid with multiple teams.

        source_message_channel_id : typing.Optional[str]
            Channel ID of the source message, if this incident was created from one

        source_message_timestamp : typing.Optional[str]
            Timestamp of the source message, if this incident was created from one

        status : typing.Optional[IncidentsCreatePayloadV1Status]
            Current status of the incident

        summary : typing.Optional[str]
            Detailed description of the incident

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        IncidentsCreateResultV1
            OK response.

        Examples
        --------
        from fern import (
            CustomFieldEntryPayloadV1,
            CustomFieldValuePayloadV1,
            IncidentIO,
            IncidentRoleAssignmentPayloadV1,
            UserReferencePayloadV1,
        )

        client = IncidentIO()
        client.incidents_v1.create(
            custom_field_entries=[
                CustomFieldEntryPayloadV1(
                    custom_field_id="01FCNDV6P870EA6S7TK1DSYDG0",
                    values=[
                        CustomFieldValuePayloadV1(
                            id="01FCNDV6P870EA6S7TK1DSYDG0",
                            value_catalog_entry_id="01FCNDV6P870EA6S7TK1DSYDG0",
                            value_link="https://google.com/",
                            value_numeric="123.456",
                            value_option_id="01FCNDV6P870EA6S7TK1DSYDG0",
                            value_text="This is my text field, I hope you like it",
                            value_timestamp="",
                        )
                    ],
                )
            ],
            idempotency_key="alert-uuid",
            incident_role_assignments=[
                IncidentRoleAssignmentPayloadV1(
                    assignee=UserReferencePayloadV1(
                        email="bob@example.com",
                        id="01G0J1EXE7AXZ2C93K61WBPYEH",
                        slack_user_id="USER123",
                    ),
                    incident_role_id="01FH5TZRWMNAFB0DZ23FD1TV96",
                )
            ],
            incident_type_id="01FH5TZRWMNAFB0DZ23FD1TV96",
            mode="real",
            name="Our database is sad",
            severity_id="01FH5TZRWMNAFB0DZ23FD1TV96",
            slack_team_id="T02A1FSLE8J",
            source_message_channel_id="C02AW36C1M5",
            source_message_timestamp="1653650280.526509",
            status="triage",
            summary="Our database is really really sad, and we don't know why yet.",
            visibility="public",
        )
        """
        _response = self._raw_client.create(
            idempotency_key=idempotency_key,
            visibility=visibility,
            custom_field_entries=custom_field_entries,
            incident_role_assignments=incident_role_assignments,
            incident_type_id=incident_type_id,
            mode=mode,
            name=name,
            severity_id=severity_id,
            slack_team_id=slack_team_id,
            source_message_channel_id=source_message_channel_id,
            source_message_timestamp=source_message_timestamp,
            status=status,
            summary=summary,
            request_options=request_options,
        )
        return _response.data

    def show(self, id: str, *, request_options: typing.Optional[RequestOptions] = None) -> IncidentsShowResultV1:
        """
        Get a single incident.

        Parameters
        ----------
        id : str
            Unique identifier for the incident

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        IncidentsShowResultV1
            OK response.

        Examples
        --------
        from fern import IncidentIO

        client = IncidentIO()
        client.incidents_v1.show(
            id="01FDAG4SAP5TYPT98WGR2N7W91",
        )
        """
        _response = self._raw_client.show(id, request_options=request_options)
        return _response.data


class AsyncIncidentsV1Client:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawIncidentsV1Client(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawIncidentsV1Client:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawIncidentsV1Client
        """
        return self._raw_client

    async def list(
        self,
        *,
        page_size: typing.Optional[int] = None,
        after: typing.Optional[str] = None,
        status: typing.Optional[typing.Union[str, typing.Sequence[str]]] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> IncidentsListResultV1:
        """
        List all incidents for an organisation.

        Parameters
        ----------
        page_size : typing.Optional[int]
            Integer number of records to return

        after : typing.Optional[str]
            An record's ID. This endpoint will return a list of records after this ID in relation to the API response order.

        status : typing.Optional[typing.Union[str, typing.Sequence[str]]]
            Filter for incidents in these statuses

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        IncidentsListResultV1
            OK response.

        Examples
        --------
        import asyncio

        from fern import AsyncIncidentIO

        client = AsyncIncidentIO()


        async def main() -> None:
            await client.incidents_v1.list(
                page_size=25,
                after="01FDAG4SAP5TYPT98WGR2N7W91",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.list(
            page_size=page_size, after=after, status=status, request_options=request_options
        )
        return _response.data

    async def create(
        self,
        *,
        idempotency_key: str,
        visibility: IncidentsCreatePayloadV1Visibility,
        custom_field_entries: typing.Optional[typing.Sequence[CustomFieldEntryPayloadV1]] = OMIT,
        incident_role_assignments: typing.Optional[typing.Sequence[IncidentRoleAssignmentPayloadV1]] = OMIT,
        incident_type_id: typing.Optional[str] = OMIT,
        mode: typing.Optional[IncidentsCreatePayloadV1Mode] = OMIT,
        name: typing.Optional[str] = OMIT,
        severity_id: typing.Optional[str] = OMIT,
        slack_team_id: typing.Optional[str] = OMIT,
        source_message_channel_id: typing.Optional[str] = OMIT,
        source_message_timestamp: typing.Optional[str] = OMIT,
        status: typing.Optional[IncidentsCreatePayloadV1Status] = OMIT,
        summary: typing.Optional[str] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> IncidentsCreateResultV1:
        """
        Create a new incident.

        Parameters
        ----------
        idempotency_key : str
            Unique string used to de-duplicate incident create requests

        visibility : IncidentsCreatePayloadV1Visibility
            Whether the incident should be open to anyone in your Slack workspace (public), or invite-only (private). For more information on Private Incidents see our [help centre](https://help.incident.io/articles/5905558102-can-we-mark-incidents-as-sensitive-and-restrict-access).

        custom_field_entries : typing.Optional[typing.Sequence[CustomFieldEntryPayloadV1]]
            Set the incident's custom fields to these values

        incident_role_assignments : typing.Optional[typing.Sequence[IncidentRoleAssignmentPayloadV1]]
            Assign incident roles to these people

        incident_type_id : typing.Optional[str]
            Incident type to create this incident as

        mode : typing.Optional[IncidentsCreatePayloadV1Mode]
            Whether the incident is real or test

        name : typing.Optional[str]
            Explanation of the incident

        severity_id : typing.Optional[str]
            Severity to create incident as

        slack_team_id : typing.Optional[str]
            ID of the Slack team / workspace. This is only required if you are using a Slack Enterprise Grid with multiple teams.

        source_message_channel_id : typing.Optional[str]
            Channel ID of the source message, if this incident was created from one

        source_message_timestamp : typing.Optional[str]
            Timestamp of the source message, if this incident was created from one

        status : typing.Optional[IncidentsCreatePayloadV1Status]
            Current status of the incident

        summary : typing.Optional[str]
            Detailed description of the incident

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        IncidentsCreateResultV1
            OK response.

        Examples
        --------
        import asyncio

        from fern import (
            AsyncIncidentIO,
            CustomFieldEntryPayloadV1,
            CustomFieldValuePayloadV1,
            IncidentRoleAssignmentPayloadV1,
            UserReferencePayloadV1,
        )

        client = AsyncIncidentIO()


        async def main() -> None:
            await client.incidents_v1.create(
                custom_field_entries=[
                    CustomFieldEntryPayloadV1(
                        custom_field_id="01FCNDV6P870EA6S7TK1DSYDG0",
                        values=[
                            CustomFieldValuePayloadV1(
                                id="01FCNDV6P870EA6S7TK1DSYDG0",
                                value_catalog_entry_id="01FCNDV6P870EA6S7TK1DSYDG0",
                                value_link="https://google.com/",
                                value_numeric="123.456",
                                value_option_id="01FCNDV6P870EA6S7TK1DSYDG0",
                                value_text="This is my text field, I hope you like it",
                                value_timestamp="",
                            )
                        ],
                    )
                ],
                idempotency_key="alert-uuid",
                incident_role_assignments=[
                    IncidentRoleAssignmentPayloadV1(
                        assignee=UserReferencePayloadV1(
                            email="bob@example.com",
                            id="01G0J1EXE7AXZ2C93K61WBPYEH",
                            slack_user_id="USER123",
                        ),
                        incident_role_id="01FH5TZRWMNAFB0DZ23FD1TV96",
                    )
                ],
                incident_type_id="01FH5TZRWMNAFB0DZ23FD1TV96",
                mode="real",
                name="Our database is sad",
                severity_id="01FH5TZRWMNAFB0DZ23FD1TV96",
                slack_team_id="T02A1FSLE8J",
                source_message_channel_id="C02AW36C1M5",
                source_message_timestamp="1653650280.526509",
                status="triage",
                summary="Our database is really really sad, and we don't know why yet.",
                visibility="public",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.create(
            idempotency_key=idempotency_key,
            visibility=visibility,
            custom_field_entries=custom_field_entries,
            incident_role_assignments=incident_role_assignments,
            incident_type_id=incident_type_id,
            mode=mode,
            name=name,
            severity_id=severity_id,
            slack_team_id=slack_team_id,
            source_message_channel_id=source_message_channel_id,
            source_message_timestamp=source_message_timestamp,
            status=status,
            summary=summary,
            request_options=request_options,
        )
        return _response.data

    async def show(self, id: str, *, request_options: typing.Optional[RequestOptions] = None) -> IncidentsShowResultV1:
        """
        Get a single incident.

        Parameters
        ----------
        id : str
            Unique identifier for the incident

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        IncidentsShowResultV1
            OK response.

        Examples
        --------
        import asyncio

        from fern import AsyncIncidentIO

        client = AsyncIncidentIO()


        async def main() -> None:
            await client.incidents_v1.show(
                id="01FDAG4SAP5TYPT98WGR2N7W91",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.show(id, request_options=request_options)
        return _response.data
