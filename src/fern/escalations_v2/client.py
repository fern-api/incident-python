# This file was auto-generated by Fern from our API Definition.

import typing

from ..core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ..core.request_options import RequestOptions
from ..types.escalation_path_node_payload_v2 import EscalationPathNodePayloadV2
from ..types.escalations_create_path_result_v2 import EscalationsCreatePathResultV2
from ..types.escalations_create_result_v2 import EscalationsCreateResultV2
from ..types.escalations_list_result_v2 import EscalationsListResultV2
from ..types.escalations_show_path_result_v2 import EscalationsShowPathResultV2
from ..types.escalations_show_result_v2 import EscalationsShowResultV2
from ..types.escalations_update_path_result_v2 import EscalationsUpdatePathResultV2
from ..types.weekday_interval_config_v2 import WeekdayIntervalConfigV2
from .raw_client import AsyncRawEscalationsV2Client, RawEscalationsV2Client

# this is used as the default value for optional parameters
OMIT = typing.cast(typing.Any, ...)


class EscalationsV2Client:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawEscalationsV2Client(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawEscalationsV2Client:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawEscalationsV2Client
        """
        return self._raw_client

    def createpath(
        self,
        *,
        name: str,
        path: typing.Sequence[EscalationPathNodePayloadV2],
        team_ids: typing.Optional[typing.Sequence[str]] = OMIT,
        working_hours: typing.Optional[typing.Sequence[WeekdayIntervalConfigV2]] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> EscalationsCreatePathResultV2:
        """
        Create an escalation path.

        An escalation path is a series of steps that describe how a page should be escalated,
        represented as graph, supporting conditional branches based on alert priority and working
        intervals.

        We recommend you create escalation paths in the incident.io dashboard where our path
        builder makes it easy to use conditions and visualise the path.

        Parameters
        ----------
        name : str
            The name of this escalation path, for the user's reference.

        path : typing.Sequence[EscalationPathNodePayloadV2]
            The nodes that form the levels and branches of this escalation path.

        team_ids : typing.Optional[typing.Sequence[str]]
            IDs of the teams that own this escalation path. This will automatically sync escalation paths with the right teams in Catalog. If you have an escalation paths attribute on your Teams, this attribute is required.

        working_hours : typing.Optional[typing.Sequence[WeekdayIntervalConfigV2]]
            The working hours for this escalation path.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EscalationsCreatePathResultV2
            Created response.

        Examples
        --------
        from fern import (
            ConditionPayloadV2,
            EngineParamBindingPayloadV2,
            EngineParamBindingValuePayloadV2,
            EscalationPathNodeIfElsePayloadV2,
            EscalationPathNodeLevelV2,
            EscalationPathNodeNotifyChannelV2,
            EscalationPathNodePayloadV2,
            EscalationPathNodeRepeatV2,
            EscalationPathRoundRobinConfigV2,
            EscalationPathTargetV2,
            IncidentIO,
            WeekdayIntervalConfigV2,
            WeekdayIntervalV2,
        )

        client = IncidentIO()
        client.escalations_v2.createpath(
            name="Urgent Support",
            path=[
                EscalationPathNodePayloadV2(
                    id="01FCNDV6P870EA6S7TK1DSYDG0",
                    if_else=EscalationPathNodeIfElsePayloadV2(
                        conditions=[
                            ConditionPayloadV2(
                                operation="one_of",
                                param_bindings=[
                                    EngineParamBindingPayloadV2(
                                        array_value=[
                                            EngineParamBindingValuePayloadV2(
                                                literal="SEV123",
                                                reference="incident.severity",
                                            )
                                        ],
                                        value=EngineParamBindingValuePayloadV2(
                                            literal="SEV123",
                                            reference="incident.severity",
                                        ),
                                    )
                                ],
                                subject="incident.severity",
                            )
                        ],
                        else_path=[],
                        then_path=[],
                    ),
                    level=EscalationPathNodeLevelV2(
                        ack_mode="all",
                        round_robin_config=EscalationPathRoundRobinConfigV2(
                            enabled=False,
                            rotate_after_seconds=120,
                        ),
                        targets=[
                            EscalationPathTargetV2(
                                id="lawrencejones",
                                schedule_mode="currently_on_call",
                                type="schedule",
                                urgency="high",
                            )
                        ],
                        time_to_ack_interval_condition="active",
                        time_to_ack_seconds=1800,
                        time_to_ack_weekday_interval_config_id="01FCNDV6P870EA6S7TK1DSYDG0",
                    ),
                    notify_channel=EscalationPathNodeNotifyChannelV2(
                        targets=[
                            EscalationPathTargetV2(
                                id="lawrencejones",
                                schedule_mode="currently_on_call",
                                type="schedule",
                                urgency="high",
                            )
                        ],
                        time_to_ack_interval_condition="active",
                        time_to_ack_seconds=1800,
                        time_to_ack_weekday_interval_config_id="01FCNDV6P870EA6S7TK1DSYDG0",
                    ),
                    repeat=EscalationPathNodeRepeatV2(
                        repeat_times=3,
                        to_node="01FCNDV6P870EA6S7TK1DSYDG0",
                    ),
                    type="if_else",
                )
            ],
            team_ids=["01JPQA75EPNEES4479P16P4XAB"],
            working_hours=[
                WeekdayIntervalConfigV2(
                    id="abc123",
                    name="abc123",
                    timezone="abc123",
                    weekday_intervals=[
                        WeekdayIntervalV2(
                            end_time="17:00",
                            start_time="09:00",
                            weekday="monday",
                        )
                    ],
                )
            ],
        )
        """
        _response = self._raw_client.createpath(
            name=name, path=path, team_ids=team_ids, working_hours=working_hours, request_options=request_options
        )
        return _response.data

    def showpath(
        self, id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> EscalationsShowPathResultV2:
        """
        Show an escalation path.

        We recommend you create escalation paths in the incident.io dashboard where our path
        builder makes it easy to use conditions and visualise the path.

        Parameters
        ----------
        id : str
            Unique identifier for this escalation path.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EscalationsShowPathResultV2
            OK response.

        Examples
        --------
        from fern import IncidentIO

        client = IncidentIO()
        client.escalations_v2.showpath(
            id="01FCNDV6P870EA6S7TK1DSYDG0",
        )
        """
        _response = self._raw_client.showpath(id, request_options=request_options)
        return _response.data

    def updatepath(
        self,
        id: str,
        *,
        name: str,
        path: typing.Sequence[EscalationPathNodePayloadV2],
        team_ids: typing.Optional[typing.Sequence[str]] = OMIT,
        working_hours: typing.Optional[typing.Sequence[WeekdayIntervalConfigV2]] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> EscalationsUpdatePathResultV2:
        """
        Updates an escalation path.

        We recommend you create escalation paths in the incident.io dashboard where our path
        builder makes it easy to use conditions and visualise the path.

        Parameters
        ----------
        id : str
            Unique identifier for this escalation path.

        name : str
            The name of this escalation path, for the user's reference.

        path : typing.Sequence[EscalationPathNodePayloadV2]
            The nodes that form the levels and branches of this escalation path.

        team_ids : typing.Optional[typing.Sequence[str]]
            IDs of the teams that own this escalation path. This will automatically sync escalation paths with the right teams in Catalog. If you have an escalation paths attribute on your Teams, this attribute is required.

        working_hours : typing.Optional[typing.Sequence[WeekdayIntervalConfigV2]]
            The working hours for this escalation path.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EscalationsUpdatePathResultV2
            OK response.

        Examples
        --------
        from fern import (
            ConditionPayloadV2,
            EngineParamBindingPayloadV2,
            EngineParamBindingValuePayloadV2,
            EscalationPathNodeIfElsePayloadV2,
            EscalationPathNodeLevelV2,
            EscalationPathNodeNotifyChannelV2,
            EscalationPathNodePayloadV2,
            EscalationPathNodeRepeatV2,
            EscalationPathRoundRobinConfigV2,
            EscalationPathTargetV2,
            IncidentIO,
            WeekdayIntervalConfigV2,
            WeekdayIntervalV2,
        )

        client = IncidentIO()
        client.escalations_v2.updatepath(
            id="01FCNDV6P870EA6S7TK1DSYDG0",
            name="Urgent Support",
            path=[
                EscalationPathNodePayloadV2(
                    id="01FCNDV6P870EA6S7TK1DSYDG0",
                    if_else=EscalationPathNodeIfElsePayloadV2(
                        conditions=[
                            ConditionPayloadV2(
                                operation="one_of",
                                param_bindings=[
                                    EngineParamBindingPayloadV2(
                                        array_value=[
                                            EngineParamBindingValuePayloadV2(
                                                literal="SEV123",
                                                reference="incident.severity",
                                            )
                                        ],
                                        value=EngineParamBindingValuePayloadV2(
                                            literal="SEV123",
                                            reference="incident.severity",
                                        ),
                                    )
                                ],
                                subject="incident.severity",
                            )
                        ],
                        else_path=[],
                        then_path=[],
                    ),
                    level=EscalationPathNodeLevelV2(
                        ack_mode="all",
                        round_robin_config=EscalationPathRoundRobinConfigV2(
                            enabled=False,
                            rotate_after_seconds=120,
                        ),
                        targets=[
                            EscalationPathTargetV2(
                                id="lawrencejones",
                                schedule_mode="currently_on_call",
                                type="schedule",
                                urgency="high",
                            )
                        ],
                        time_to_ack_interval_condition="active",
                        time_to_ack_seconds=1800,
                        time_to_ack_weekday_interval_config_id="01FCNDV6P870EA6S7TK1DSYDG0",
                    ),
                    notify_channel=EscalationPathNodeNotifyChannelV2(
                        targets=[
                            EscalationPathTargetV2(
                                id="lawrencejones",
                                schedule_mode="currently_on_call",
                                type="schedule",
                                urgency="high",
                            )
                        ],
                        time_to_ack_interval_condition="active",
                        time_to_ack_seconds=1800,
                        time_to_ack_weekday_interval_config_id="01FCNDV6P870EA6S7TK1DSYDG0",
                    ),
                    repeat=EscalationPathNodeRepeatV2(
                        repeat_times=3,
                        to_node="01FCNDV6P870EA6S7TK1DSYDG0",
                    ),
                    type="if_else",
                )
            ],
            team_ids=["01JPQA75EPNEES4479P16P4XAB"],
            working_hours=[
                WeekdayIntervalConfigV2(
                    id="abc123",
                    name="abc123",
                    timezone="abc123",
                    weekday_intervals=[
                        WeekdayIntervalV2(
                            end_time="17:00",
                            start_time="09:00",
                            weekday="monday",
                        )
                    ],
                )
            ],
        )
        """
        _response = self._raw_client.updatepath(
            id, name=name, path=path, team_ids=team_ids, working_hours=working_hours, request_options=request_options
        )
        return _response.data

    def destroypath(self, id: str, *, request_options: typing.Optional[RequestOptions] = None) -> None:
        """
        Archives an escalation path.

        We recommend you create escalation paths in the incident.io dashboard where our path
        builder makes it easy to use conditions and visualise the path.

        Parameters
        ----------
        id : str
            Unique identifier for this escalation path.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        None

        Examples
        --------
        from fern import IncidentIO

        client = IncidentIO()
        client.escalations_v2.destroypath(
            id="01FCNDV6P870EA6S7TK1DSYDG0",
        )
        """
        _response = self._raw_client.destroypath(id, request_options=request_options)
        return _response.data

    def list(
        self,
        *,
        page_size: typing.Optional[int] = None,
        after: typing.Optional[str] = None,
        escalation_path: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        status: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        alert: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        created_at: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        updated_at: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        idempotency_key: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> EscalationsListResultV2:
        """
        List all escalations for your account.
        
        This endpoint supports a number of filters, which can help find escalations matching certain
        criteria.
        
        Note that:
        - Filters may be used together, and the result will be escalations that match all filters.
        - All query parameters must be URI encoded.
        
        To use this API, you will need an API key with the "View data" or "Create and manage on-call resources" permission.
        
        ### By escalation_path
        
        Find all escalations that escalated to escalation path with id=ABC:
        
                curl --get 'https://api.incident.io/v2/escalations' \\
                    --data 'escalation_path[one_of]=ABC'
        
        ### By status
        
        Find all escalations with a current status of "triggered":
        
                curl --get 'https://api.incident.io/v2/escalations' \\
                    --data 'status[one_of]=triggered'
        
        Possible values are "pending", "triggered", "acked", "resolved", "expired" and "cancelled".
        Escalations are in "pending" when they are in a grace period when the related alert has
        been grouped in an incident.
        
        ### By alert
        
        Find all escalations that were created by alert with id=ABC:
        
                curl --get 'https://api.incident.io/v2/escalations' \\
                    --data 'alert[one_of]=ABC'
        
        ### By created_at and updated_at
        Find all escalations that follow specified date parameters for created_at and updated_at fields.
        Possible values are "gte" (greater than or equal to), "lte" (less than or equal to), and
        "date_range" (between two dates).
        For example, to find all escalations updated after 2025-01-01:
        
                curl --get 'https://api.incident.io/v2/escalations' \\
                    --data 'updated_at[gte]=2025-01-01'
        
        To find all escalations created between 2025-01-01 and 2025-01-31:
        
                curl --get 'https://api.incident.io/v2/escalations' \\
                    --data 'created_at[date_range]=2025-01-01~2025-01-31'
        
        Parameters
        ----------
        page_size : typing.Optional[int]
            Number of escalations to return per page
        
        after : typing.Optional[str]
            An escalation's ID. This endpoint will return a list of escalations after this ID in relation to the API response order.
        
        escalation_path : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the escalation path for which the escalation was triggered. Accepted operators are 'one_of' and 'not_in'.
        
        status : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the status of the escalation. Accepted operators are 'one_of' and 'not_in'.
        
        alert : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the alert that created an escalation. Accepted operators are 'one_of' and 'not_in'.
        
        created_at : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the created_at timestamp of the escalation. Accepted operators are 'gte', 'lte' and 'date_range'.
        
        updated_at : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the updated_at timestamp of the escalation. Accepted operators are 'gte', 'lte' and 'date_range'.
        
        idempotency_key : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the idempotency key of the escalation. This is the key set when creating escalations via the API, and is distinct from alert deduplication keys. Accepted operators are 'is' for exact matches and 'starts_with' for prefix matching.
        
        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.
        
        Returns
        -------
        EscalationsListResultV2
            OK response.
        
        Examples
        --------
        from fern import IncidentIO
        
        client = IncidentIO()
        client.escalations_v2.list(
            page_size=25,
            after="01FDAG4SAP5TYPT98WGR2N7W91",
        )
        """
        _response = self._raw_client.list(
            page_size=page_size,
            after=after,
            escalation_path=escalation_path,
            status=status,
            alert=alert,
            created_at=created_at,
            updated_at=updated_at,
            idempotency_key=idempotency_key,
            request_options=request_options,
        )
        return _response.data

    def create(
        self,
        *,
        idempotency_key: str,
        title: str,
        description: typing.Optional[str] = OMIT,
        escalation_path_id: typing.Optional[str] = OMIT,
        user_ids: typing.Optional[typing.Sequence[str]] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> EscalationsCreateResultV2:
        """
        Create an escalation.

        An escalation pages people, either according to an escalation path, or directly to
        specific users. You must provide either an escalation_path_id OR user_ids, but not both.

        When escalating via an escalation path, the escalation will follow the configured path
        with its levels and timeouts, using your default [alert
        priority](https://app.incident.io/~/settings/alerts/configuration/priorities).

        When escalating directly to users, they will receive a high-urgency
        notification, based on their notification rules.

        This endpoint is rate-limited to 60 requests per minute, since it is intended for
        interactive use cases (for example someone clicking a "escalate to team" button
        in your internal developer platform). To escalate based on automated alerts, we
        recommend sending events to an alert source instead.

        Parameters
        ----------
        idempotency_key : str
            Unique key to prevent duplicate escalations. If this key has already been used, the existing escalation will be returned.

        title : str
            The title of the escalation. This message will be included in all notifications about this escalation.

        description : typing.Optional[str]
            Additional details about the escalation

        escalation_path_id : typing.Optional[str]
            ID of the escalation path to follow

        user_ids : typing.Optional[typing.Sequence[str]]
            IDs of users to escalate directly to

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EscalationsCreateResultV2
            Created response.

        Examples
        --------
        from fern import IncidentIO

        client = IncidentIO()
        client.escalations_v2.create(
            description="Database CPU has been above 90% for 5 minutes",
            escalation_path_id="01H0J1EXE7AXZ2C93K61WBPYEH",
            idempotency_key="2024-01-15-abc123",
            title="Production database experiencing high CPU",
            user_ids=["01H0J1EXE7AXZ2C93K61WBPYEH", "01H0J1EXE7AXZ2C93K61WBPYEI"],
        )
        """
        _response = self._raw_client.create(
            idempotency_key=idempotency_key,
            title=title,
            description=description,
            escalation_path_id=escalation_path_id,
            user_ids=user_ids,
            request_options=request_options,
        )
        return _response.data

    def show(self, id: str, *, request_options: typing.Optional[RequestOptions] = None) -> EscalationsShowResultV2:
        """
        Show a specific escalation.

        Parameters
        ----------
        id : str
            Unique ID of the escalation

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EscalationsShowResultV2
            OK response.

        Examples
        --------
        from fern import IncidentIO

        client = IncidentIO()
        client.escalations_v2.show(
            id="01G0J1EXE7AXZ2C93K61WBPYEH",
        )
        """
        _response = self._raw_client.show(id, request_options=request_options)
        return _response.data


class AsyncEscalationsV2Client:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawEscalationsV2Client(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawEscalationsV2Client:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawEscalationsV2Client
        """
        return self._raw_client

    async def createpath(
        self,
        *,
        name: str,
        path: typing.Sequence[EscalationPathNodePayloadV2],
        team_ids: typing.Optional[typing.Sequence[str]] = OMIT,
        working_hours: typing.Optional[typing.Sequence[WeekdayIntervalConfigV2]] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> EscalationsCreatePathResultV2:
        """
        Create an escalation path.

        An escalation path is a series of steps that describe how a page should be escalated,
        represented as graph, supporting conditional branches based on alert priority and working
        intervals.

        We recommend you create escalation paths in the incident.io dashboard where our path
        builder makes it easy to use conditions and visualise the path.

        Parameters
        ----------
        name : str
            The name of this escalation path, for the user's reference.

        path : typing.Sequence[EscalationPathNodePayloadV2]
            The nodes that form the levels and branches of this escalation path.

        team_ids : typing.Optional[typing.Sequence[str]]
            IDs of the teams that own this escalation path. This will automatically sync escalation paths with the right teams in Catalog. If you have an escalation paths attribute on your Teams, this attribute is required.

        working_hours : typing.Optional[typing.Sequence[WeekdayIntervalConfigV2]]
            The working hours for this escalation path.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EscalationsCreatePathResultV2
            Created response.

        Examples
        --------
        import asyncio

        from fern import (
            AsyncIncidentIO,
            ConditionPayloadV2,
            EngineParamBindingPayloadV2,
            EngineParamBindingValuePayloadV2,
            EscalationPathNodeIfElsePayloadV2,
            EscalationPathNodeLevelV2,
            EscalationPathNodeNotifyChannelV2,
            EscalationPathNodePayloadV2,
            EscalationPathNodeRepeatV2,
            EscalationPathRoundRobinConfigV2,
            EscalationPathTargetV2,
            WeekdayIntervalConfigV2,
            WeekdayIntervalV2,
        )

        client = AsyncIncidentIO()


        async def main() -> None:
            await client.escalations_v2.createpath(
                name="Urgent Support",
                path=[
                    EscalationPathNodePayloadV2(
                        id="01FCNDV6P870EA6S7TK1DSYDG0",
                        if_else=EscalationPathNodeIfElsePayloadV2(
                            conditions=[
                                ConditionPayloadV2(
                                    operation="one_of",
                                    param_bindings=[
                                        EngineParamBindingPayloadV2(
                                            array_value=[
                                                EngineParamBindingValuePayloadV2(
                                                    literal="SEV123",
                                                    reference="incident.severity",
                                                )
                                            ],
                                            value=EngineParamBindingValuePayloadV2(
                                                literal="SEV123",
                                                reference="incident.severity",
                                            ),
                                        )
                                    ],
                                    subject="incident.severity",
                                )
                            ],
                            else_path=[],
                            then_path=[],
                        ),
                        level=EscalationPathNodeLevelV2(
                            ack_mode="all",
                            round_robin_config=EscalationPathRoundRobinConfigV2(
                                enabled=False,
                                rotate_after_seconds=120,
                            ),
                            targets=[
                                EscalationPathTargetV2(
                                    id="lawrencejones",
                                    schedule_mode="currently_on_call",
                                    type="schedule",
                                    urgency="high",
                                )
                            ],
                            time_to_ack_interval_condition="active",
                            time_to_ack_seconds=1800,
                            time_to_ack_weekday_interval_config_id="01FCNDV6P870EA6S7TK1DSYDG0",
                        ),
                        notify_channel=EscalationPathNodeNotifyChannelV2(
                            targets=[
                                EscalationPathTargetV2(
                                    id="lawrencejones",
                                    schedule_mode="currently_on_call",
                                    type="schedule",
                                    urgency="high",
                                )
                            ],
                            time_to_ack_interval_condition="active",
                            time_to_ack_seconds=1800,
                            time_to_ack_weekday_interval_config_id="01FCNDV6P870EA6S7TK1DSYDG0",
                        ),
                        repeat=EscalationPathNodeRepeatV2(
                            repeat_times=3,
                            to_node="01FCNDV6P870EA6S7TK1DSYDG0",
                        ),
                        type="if_else",
                    )
                ],
                team_ids=["01JPQA75EPNEES4479P16P4XAB"],
                working_hours=[
                    WeekdayIntervalConfigV2(
                        id="abc123",
                        name="abc123",
                        timezone="abc123",
                        weekday_intervals=[
                            WeekdayIntervalV2(
                                end_time="17:00",
                                start_time="09:00",
                                weekday="monday",
                            )
                        ],
                    )
                ],
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.createpath(
            name=name, path=path, team_ids=team_ids, working_hours=working_hours, request_options=request_options
        )
        return _response.data

    async def showpath(
        self, id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> EscalationsShowPathResultV2:
        """
        Show an escalation path.

        We recommend you create escalation paths in the incident.io dashboard where our path
        builder makes it easy to use conditions and visualise the path.

        Parameters
        ----------
        id : str
            Unique identifier for this escalation path.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EscalationsShowPathResultV2
            OK response.

        Examples
        --------
        import asyncio

        from fern import AsyncIncidentIO

        client = AsyncIncidentIO()


        async def main() -> None:
            await client.escalations_v2.showpath(
                id="01FCNDV6P870EA6S7TK1DSYDG0",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.showpath(id, request_options=request_options)
        return _response.data

    async def updatepath(
        self,
        id: str,
        *,
        name: str,
        path: typing.Sequence[EscalationPathNodePayloadV2],
        team_ids: typing.Optional[typing.Sequence[str]] = OMIT,
        working_hours: typing.Optional[typing.Sequence[WeekdayIntervalConfigV2]] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> EscalationsUpdatePathResultV2:
        """
        Updates an escalation path.

        We recommend you create escalation paths in the incident.io dashboard where our path
        builder makes it easy to use conditions and visualise the path.

        Parameters
        ----------
        id : str
            Unique identifier for this escalation path.

        name : str
            The name of this escalation path, for the user's reference.

        path : typing.Sequence[EscalationPathNodePayloadV2]
            The nodes that form the levels and branches of this escalation path.

        team_ids : typing.Optional[typing.Sequence[str]]
            IDs of the teams that own this escalation path. This will automatically sync escalation paths with the right teams in Catalog. If you have an escalation paths attribute on your Teams, this attribute is required.

        working_hours : typing.Optional[typing.Sequence[WeekdayIntervalConfigV2]]
            The working hours for this escalation path.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EscalationsUpdatePathResultV2
            OK response.

        Examples
        --------
        import asyncio

        from fern import (
            AsyncIncidentIO,
            ConditionPayloadV2,
            EngineParamBindingPayloadV2,
            EngineParamBindingValuePayloadV2,
            EscalationPathNodeIfElsePayloadV2,
            EscalationPathNodeLevelV2,
            EscalationPathNodeNotifyChannelV2,
            EscalationPathNodePayloadV2,
            EscalationPathNodeRepeatV2,
            EscalationPathRoundRobinConfigV2,
            EscalationPathTargetV2,
            WeekdayIntervalConfigV2,
            WeekdayIntervalV2,
        )

        client = AsyncIncidentIO()


        async def main() -> None:
            await client.escalations_v2.updatepath(
                id="01FCNDV6P870EA6S7TK1DSYDG0",
                name="Urgent Support",
                path=[
                    EscalationPathNodePayloadV2(
                        id="01FCNDV6P870EA6S7TK1DSYDG0",
                        if_else=EscalationPathNodeIfElsePayloadV2(
                            conditions=[
                                ConditionPayloadV2(
                                    operation="one_of",
                                    param_bindings=[
                                        EngineParamBindingPayloadV2(
                                            array_value=[
                                                EngineParamBindingValuePayloadV2(
                                                    literal="SEV123",
                                                    reference="incident.severity",
                                                )
                                            ],
                                            value=EngineParamBindingValuePayloadV2(
                                                literal="SEV123",
                                                reference="incident.severity",
                                            ),
                                        )
                                    ],
                                    subject="incident.severity",
                                )
                            ],
                            else_path=[],
                            then_path=[],
                        ),
                        level=EscalationPathNodeLevelV2(
                            ack_mode="all",
                            round_robin_config=EscalationPathRoundRobinConfigV2(
                                enabled=False,
                                rotate_after_seconds=120,
                            ),
                            targets=[
                                EscalationPathTargetV2(
                                    id="lawrencejones",
                                    schedule_mode="currently_on_call",
                                    type="schedule",
                                    urgency="high",
                                )
                            ],
                            time_to_ack_interval_condition="active",
                            time_to_ack_seconds=1800,
                            time_to_ack_weekday_interval_config_id="01FCNDV6P870EA6S7TK1DSYDG0",
                        ),
                        notify_channel=EscalationPathNodeNotifyChannelV2(
                            targets=[
                                EscalationPathTargetV2(
                                    id="lawrencejones",
                                    schedule_mode="currently_on_call",
                                    type="schedule",
                                    urgency="high",
                                )
                            ],
                            time_to_ack_interval_condition="active",
                            time_to_ack_seconds=1800,
                            time_to_ack_weekday_interval_config_id="01FCNDV6P870EA6S7TK1DSYDG0",
                        ),
                        repeat=EscalationPathNodeRepeatV2(
                            repeat_times=3,
                            to_node="01FCNDV6P870EA6S7TK1DSYDG0",
                        ),
                        type="if_else",
                    )
                ],
                team_ids=["01JPQA75EPNEES4479P16P4XAB"],
                working_hours=[
                    WeekdayIntervalConfigV2(
                        id="abc123",
                        name="abc123",
                        timezone="abc123",
                        weekday_intervals=[
                            WeekdayIntervalV2(
                                end_time="17:00",
                                start_time="09:00",
                                weekday="monday",
                            )
                        ],
                    )
                ],
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.updatepath(
            id, name=name, path=path, team_ids=team_ids, working_hours=working_hours, request_options=request_options
        )
        return _response.data

    async def destroypath(self, id: str, *, request_options: typing.Optional[RequestOptions] = None) -> None:
        """
        Archives an escalation path.

        We recommend you create escalation paths in the incident.io dashboard where our path
        builder makes it easy to use conditions and visualise the path.

        Parameters
        ----------
        id : str
            Unique identifier for this escalation path.

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        None

        Examples
        --------
        import asyncio

        from fern import AsyncIncidentIO

        client = AsyncIncidentIO()


        async def main() -> None:
            await client.escalations_v2.destroypath(
                id="01FCNDV6P870EA6S7TK1DSYDG0",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.destroypath(id, request_options=request_options)
        return _response.data

    async def list(
        self,
        *,
        page_size: typing.Optional[int] = None,
        after: typing.Optional[str] = None,
        escalation_path: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        status: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        alert: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        created_at: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        updated_at: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        idempotency_key: typing.Optional[typing.Dict[str, typing.Sequence[str]]] = None,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> EscalationsListResultV2:
        """
        List all escalations for your account.
        
        This endpoint supports a number of filters, which can help find escalations matching certain
        criteria.
        
        Note that:
        - Filters may be used together, and the result will be escalations that match all filters.
        - All query parameters must be URI encoded.
        
        To use this API, you will need an API key with the "View data" or "Create and manage on-call resources" permission.
        
        ### By escalation_path
        
        Find all escalations that escalated to escalation path with id=ABC:
        
                curl --get 'https://api.incident.io/v2/escalations' \\
                    --data 'escalation_path[one_of]=ABC'
        
        ### By status
        
        Find all escalations with a current status of "triggered":
        
                curl --get 'https://api.incident.io/v2/escalations' \\
                    --data 'status[one_of]=triggered'
        
        Possible values are "pending", "triggered", "acked", "resolved", "expired" and "cancelled".
        Escalations are in "pending" when they are in a grace period when the related alert has
        been grouped in an incident.
        
        ### By alert
        
        Find all escalations that were created by alert with id=ABC:
        
                curl --get 'https://api.incident.io/v2/escalations' \\
                    --data 'alert[one_of]=ABC'
        
        ### By created_at and updated_at
        Find all escalations that follow specified date parameters for created_at and updated_at fields.
        Possible values are "gte" (greater than or equal to), "lte" (less than or equal to), and
        "date_range" (between two dates).
        For example, to find all escalations updated after 2025-01-01:
        
                curl --get 'https://api.incident.io/v2/escalations' \\
                    --data 'updated_at[gte]=2025-01-01'
        
        To find all escalations created between 2025-01-01 and 2025-01-31:
        
                curl --get 'https://api.incident.io/v2/escalations' \\
                    --data 'created_at[date_range]=2025-01-01~2025-01-31'
        
        Parameters
        ----------
        page_size : typing.Optional[int]
            Number of escalations to return per page
        
        after : typing.Optional[str]
            An escalation's ID. This endpoint will return a list of escalations after this ID in relation to the API response order.
        
        escalation_path : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the escalation path for which the escalation was triggered. Accepted operators are 'one_of' and 'not_in'.
        
        status : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the status of the escalation. Accepted operators are 'one_of' and 'not_in'.
        
        alert : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the alert that created an escalation. Accepted operators are 'one_of' and 'not_in'.
        
        created_at : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the created_at timestamp of the escalation. Accepted operators are 'gte', 'lte' and 'date_range'.
        
        updated_at : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the updated_at timestamp of the escalation. Accepted operators are 'gte', 'lte' and 'date_range'.
        
        idempotency_key : typing.Optional[typing.Dict[str, typing.Sequence[str]]]
            Filter on the idempotency key of the escalation. This is the key set when creating escalations via the API, and is distinct from alert deduplication keys. Accepted operators are 'is' for exact matches and 'starts_with' for prefix matching.
        
        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.
        
        Returns
        -------
        EscalationsListResultV2
            OK response.
        
        Examples
        --------
        import asyncio
        
        from fern import AsyncIncidentIO
        
        client = AsyncIncidentIO()
        
        
        async def main() -> None:
            await client.escalations_v2.list(
                page_size=25,
                after="01FDAG4SAP5TYPT98WGR2N7W91",
            )
        
        
        asyncio.run(main())
        """
        _response = await self._raw_client.list(
            page_size=page_size,
            after=after,
            escalation_path=escalation_path,
            status=status,
            alert=alert,
            created_at=created_at,
            updated_at=updated_at,
            idempotency_key=idempotency_key,
            request_options=request_options,
        )
        return _response.data

    async def create(
        self,
        *,
        idempotency_key: str,
        title: str,
        description: typing.Optional[str] = OMIT,
        escalation_path_id: typing.Optional[str] = OMIT,
        user_ids: typing.Optional[typing.Sequence[str]] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> EscalationsCreateResultV2:
        """
        Create an escalation.

        An escalation pages people, either according to an escalation path, or directly to
        specific users. You must provide either an escalation_path_id OR user_ids, but not both.

        When escalating via an escalation path, the escalation will follow the configured path
        with its levels and timeouts, using your default [alert
        priority](https://app.incident.io/~/settings/alerts/configuration/priorities).

        When escalating directly to users, they will receive a high-urgency
        notification, based on their notification rules.

        This endpoint is rate-limited to 60 requests per minute, since it is intended for
        interactive use cases (for example someone clicking a "escalate to team" button
        in your internal developer platform). To escalate based on automated alerts, we
        recommend sending events to an alert source instead.

        Parameters
        ----------
        idempotency_key : str
            Unique key to prevent duplicate escalations. If this key has already been used, the existing escalation will be returned.

        title : str
            The title of the escalation. This message will be included in all notifications about this escalation.

        description : typing.Optional[str]
            Additional details about the escalation

        escalation_path_id : typing.Optional[str]
            ID of the escalation path to follow

        user_ids : typing.Optional[typing.Sequence[str]]
            IDs of users to escalate directly to

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EscalationsCreateResultV2
            Created response.

        Examples
        --------
        import asyncio

        from fern import AsyncIncidentIO

        client = AsyncIncidentIO()


        async def main() -> None:
            await client.escalations_v2.create(
                description="Database CPU has been above 90% for 5 minutes",
                escalation_path_id="01H0J1EXE7AXZ2C93K61WBPYEH",
                idempotency_key="2024-01-15-abc123",
                title="Production database experiencing high CPU",
                user_ids=["01H0J1EXE7AXZ2C93K61WBPYEH", "01H0J1EXE7AXZ2C93K61WBPYEI"],
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.create(
            idempotency_key=idempotency_key,
            title=title,
            description=description,
            escalation_path_id=escalation_path_id,
            user_ids=user_ids,
            request_options=request_options,
        )
        return _response.data

    async def show(
        self, id: str, *, request_options: typing.Optional[RequestOptions] = None
    ) -> EscalationsShowResultV2:
        """
        Show a specific escalation.

        Parameters
        ----------
        id : str
            Unique ID of the escalation

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        EscalationsShowResultV2
            OK response.

        Examples
        --------
        import asyncio

        from fern import AsyncIncidentIO

        client = AsyncIncidentIO()


        async def main() -> None:
            await client.escalations_v2.show(
                id="01G0J1EXE7AXZ2C93K61WBPYEH",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.show(id, request_options=request_options)
        return _response.data
