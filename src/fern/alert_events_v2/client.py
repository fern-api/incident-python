# This file was auto-generated by Fern from our API Definition.

import typing

from ..core.client_wrapper import AsyncClientWrapper, SyncClientWrapper
from ..core.request_options import RequestOptions
from ..types.alert_events_create_http_result_v2 import AlertEventsCreateHttpResultV2
from .raw_client import AsyncRawAlertEventsV2Client, RawAlertEventsV2Client
from .types.alert_events_create_http_payload_v2status import AlertEventsCreateHttpPayloadV2Status

# this is used as the default value for optional parameters
OMIT = typing.cast(typing.Any, ...)


class AlertEventsV2Client:
    def __init__(self, *, client_wrapper: SyncClientWrapper):
        self._raw_client = RawAlertEventsV2Client(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> RawAlertEventsV2Client:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        RawAlertEventsV2Client
        """
        return self._raw_client

    def createhttp(
        self,
        alert_source_config_id: str,
        *,
        status: AlertEventsCreateHttpPayloadV2Status,
        title: str,
        token: typing.Optional[str] = None,
        deduplication_key: typing.Optional[str] = OMIT,
        description: typing.Optional[str] = OMIT,
        metadata: typing.Optional[typing.Dict[str, typing.Any]] = OMIT,
        source_url: typing.Optional[str] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> AlertEventsCreateHttpResultV2:
        """
        Create an alert event using an HTTP source.

        Parameters
        ----------
        alert_source_config_id : str
            Which alert source config produced this alert

        status : AlertEventsCreateHttpPayloadV2Status
            Current status of this alert

        title : str
            The title of the alert, parsed from the alert payload according to the alert source configuration

        token : typing.Optional[str]
            Token used to authenticate the request, generated when configuring the alert source. Will be consumed via a URL query string parameter

        deduplication_key : typing.Optional[str]
            A deduplication key which uniquely references this alert from your alert source. For newly created HTTP sources, this field is required.
            If you send an event with the same deduplication_key multiple times, only one alert will be created in incident.io for this alert source config.
            You can filter on this field to find the alert created by an event you've sent us.

        description : typing.Optional[str]
            Description that optionally adds more detail to title. Supports markdown.

        metadata : typing.Optional[typing.Dict[str, typing.Any]]
            Any additional metadata that you've configured your alert source to parse

        source_url : typing.Optional[str]
            If applicable, a link to the alert in the upstream system

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        AlertEventsCreateHttpResultV2
            Accepted response.

        Examples
        --------
        from fern import IncidentIO

        client = IncidentIO()
        client.alert_events_v2.createhttp(
            alert_source_config_id="01GW2G3V0S59R238FAHPDS1R66",
            token="some-random-string",
            deduplication_key="4293868629",
            description="We've detected a number of timeouts on hello.world.com, the service may be down. To fix...",
            metadata={"service": "hello.world.com", "team": ["my-team"]},
            source_url="https://www.my-alerting-platform.com/alerts/my-alert-123",
            status="firing",
            title="*errors.withMessage: PG::Error failed to connect",
        )
        """
        _response = self._raw_client.createhttp(
            alert_source_config_id,
            status=status,
            title=title,
            token=token,
            deduplication_key=deduplication_key,
            description=description,
            metadata=metadata,
            source_url=source_url,
            request_options=request_options,
        )
        return _response.data


class AsyncAlertEventsV2Client:
    def __init__(self, *, client_wrapper: AsyncClientWrapper):
        self._raw_client = AsyncRawAlertEventsV2Client(client_wrapper=client_wrapper)

    @property
    def with_raw_response(self) -> AsyncRawAlertEventsV2Client:
        """
        Retrieves a raw implementation of this client that returns raw responses.

        Returns
        -------
        AsyncRawAlertEventsV2Client
        """
        return self._raw_client

    async def createhttp(
        self,
        alert_source_config_id: str,
        *,
        status: AlertEventsCreateHttpPayloadV2Status,
        title: str,
        token: typing.Optional[str] = None,
        deduplication_key: typing.Optional[str] = OMIT,
        description: typing.Optional[str] = OMIT,
        metadata: typing.Optional[typing.Dict[str, typing.Any]] = OMIT,
        source_url: typing.Optional[str] = OMIT,
        request_options: typing.Optional[RequestOptions] = None,
    ) -> AlertEventsCreateHttpResultV2:
        """
        Create an alert event using an HTTP source.

        Parameters
        ----------
        alert_source_config_id : str
            Which alert source config produced this alert

        status : AlertEventsCreateHttpPayloadV2Status
            Current status of this alert

        title : str
            The title of the alert, parsed from the alert payload according to the alert source configuration

        token : typing.Optional[str]
            Token used to authenticate the request, generated when configuring the alert source. Will be consumed via a URL query string parameter

        deduplication_key : typing.Optional[str]
            A deduplication key which uniquely references this alert from your alert source. For newly created HTTP sources, this field is required.
            If you send an event with the same deduplication_key multiple times, only one alert will be created in incident.io for this alert source config.
            You can filter on this field to find the alert created by an event you've sent us.

        description : typing.Optional[str]
            Description that optionally adds more detail to title. Supports markdown.

        metadata : typing.Optional[typing.Dict[str, typing.Any]]
            Any additional metadata that you've configured your alert source to parse

        source_url : typing.Optional[str]
            If applicable, a link to the alert in the upstream system

        request_options : typing.Optional[RequestOptions]
            Request-specific configuration.

        Returns
        -------
        AlertEventsCreateHttpResultV2
            Accepted response.

        Examples
        --------
        import asyncio

        from fern import AsyncIncidentIO

        client = AsyncIncidentIO()


        async def main() -> None:
            await client.alert_events_v2.createhttp(
                alert_source_config_id="01GW2G3V0S59R238FAHPDS1R66",
                token="some-random-string",
                deduplication_key="4293868629",
                description="We've detected a number of timeouts on hello.world.com, the service may be down. To fix...",
                metadata={"service": "hello.world.com", "team": ["my-team"]},
                source_url="https://www.my-alerting-platform.com/alerts/my-alert-123",
                status="firing",
                title="*errors.withMessage: PG::Error failed to connect",
            )


        asyncio.run(main())
        """
        _response = await self._raw_client.createhttp(
            alert_source_config_id,
            status=status,
            title=title,
            token=token,
            deduplication_key=deduplication_key,
            description=description,
            metadata=metadata,
            source_url=source_url,
            request_options=request_options,
        )
        return _response.data
